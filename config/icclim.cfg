[buildout]
parts +=
     icclim_checkout 
     icclim_make
     icclim

[icclim_checkout]
recipe = collective.recipe.cmd
on_install = true
on_update = false
cmds =
     if [ -d /${buildout:directory}/src/icclim ] ; then
        cd ${buildout:directory}/src/icclim
        git pull
        echo "Updating icclim git repo... Done"
     else
        cd ${buildout:directory}/src
        git clone https://github.com/tatarinova/icclim.git
        echo "Cloning icclim git repo... Done" 
     fi

[icclim_make]
recipe = collective.recipe.cmd
on_install = true
on_update = true
cmds =
     cd ${buildout:directory}/src/icclim
     gcc -fPIC -g -c -Wall ./icclim/libC.c -o ./icclim/libC.o
     gcc -shared -o ./icclim/libC.so ./icclim/libC.o
     cd -

[icclim]
recipe = zc.recipe.egg:develop
setup = ${buildout:directory}/src/icclim/setup.py


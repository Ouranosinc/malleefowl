[ocgis_build]

parts = 
      ocgis_checkout
      ocgis_debian 
      ocgis_conda 
      ocgis_python
      ocgis

[ocgis_checkout]
recipe = collective.recipe.cmd
on_install = true
on_update = false
cmds =
     if [ -d /${buildout:directory}/src/ocgis ] ; then
        cd ${buildout:directory}/src/ocgis
        git pull
     else
        cd ${buildout:directory}/src
        git clone https://github.com/NCPP/ocgis.git
     fi

[ocgis_debian]
recipe = collective.recipe.cmd
on_install = true
on_update = false
cmds =
    if [ -f /etc/debian_version ] ; then
        sudo apt-get -y --force-yes install \
             g++ libz-dev curl wget libgeotiff-epsg 
    fi

[ocgis_conda]
recipe = collective.recipe.cmd
on_install = true
on_update = false
cmds =
     unset PYTHONPATH
     sudo /opt/anaconda/bin/conda install --yes \
          python=2.7 \
          shapely \
          numpy \
          fiona \
          netcdf4 \ 
          gdal

[ocgis_python]
recipe = collective.recipe.cmd
on_install = true
on_update = false
cmds =
     cd ${buildout:directory}/src/ocgis
     python setup.py build

[ocgis]
recipe = zc.recipe.egg:develop
setup = ${buildout:directory}/src/ocgis/setup.py

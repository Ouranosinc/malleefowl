[malleefowl_build]

parts = 
   malleefowl
   malleefowl_outputs
   malleefowl_testdata
   malleefowl_ipython
   malleefowl_nose

[malleefowl]
recipe = zc.recipe.egg
eggs =
     Malleefowl
     pywps
     OWSLib
     pyOpenSSL
     MyProxyClient
     netCDF4
     PyYAML
     cdo
     c3meta
     basemap
     esgf-pyclient
     pymongo
     qc-processes
     PyRods
     ocgis
     icclim

[malleefowl_outputs]
recipe = collective.recipe.cmd
on_install = true
on_update = true
cmds =
    sudo mkdir -p ${pywps_config:output_path}
    sudo mkdir -p ${pywps_config:temp_path}
    sudo mkdir -p ${pywps_config:cache_path}
    sudo mkdir -p ${pywps_config:files_path}
    sudo chown -R ${install:user}:${install:group} ${pywps:home}

[malleefowl_testdata]
recipe = collective.recipe.cmd
on_install = true
on_update = true
cmds =
    sudo cp ${buildout:directory}/examples/test*.nc ${pywps_config:files_path}
    sudo cp ${buildout:directory}/examples/*-wf.json ${pywps_config:files_path}
    sudo chown -R ${install:user}:${install:group} ${pywps_config:files_path}

[malleefowl_ipython]
recipe = zc.recipe.egg
eggs =
    ipython
    ${malleefowl:eggs}
    ${pywps:eggs}
entry-points =
   ipython=IPython:start_ipython
scripts =
    ipython=ipython
initialization =
    import os
    os.environ['GDAL_DATA'] = '${env:gdal_data}'

[malleefowl_nose]
recipe = zc.recipe.egg
eggs =
    nose
    ${malleefowl:eggs}
    ${pywps:eggs}
entry-points =
    nosetests=nose:run_exit
scripts =
    nosetests=nosetests
initialization =
    import os
    os.environ['GDAL_DATA'] = '${env:gdal_data}'
    os.environ['PYWPS_CFG'] = '${pywps:cfg}'



[tomcat_build]
parts =
    tomcat_debian
    tomcat_config
    tomcat_restart

[tomcat]
webapps = /var/lib/tomcat7/webapps
content = /var/lib/tomcat7/content
user = tomcat7
group = tomcat7

[tomcat_debian]
recipe = collective.recipe.cmd
on_install = true
cmds =
    if [ -f /etc/debian_version ] ; then
        sudo apt-get -y --force-yes install \
             tomcat7 \
             tomcat7-admin \
             tomcat7-user \
             libtomcat7-java
    fi


[tomcat_config]
recipe = collective.recipe.cmd
on_install = true
on_update = true
cmds =
     sudo cp ${buildout:directory}/templates/tomcat7 /etc/default/
     sudo cp ${buildout:directory}/templates/tomcat-users.xml /etc/tomcat7/

[tomcat_restart]
recipe = collective.recipe.cmd
on_install = true
on_update = true
cmds =
     sudo service tomcat7 restart
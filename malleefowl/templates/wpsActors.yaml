- id: CollectSources
  type: GroovyActor
  properties:
    initialize: |
      count = 0
      currentSources = ''
    step: |
      count = count + 1
      if (count == 1) {
        currentSources = source
      }
      else {
        currentSources = currentSources + ',' + source
      }
      if (count <  max) {
        _status.setOutputEnable('allSources', false)
      } else {
        allSources = currentSources
        _status.setOutputEnable('allSources', true)
      }
    inputs:
      max:
        default: 1
      source:
        type: String
    outputs:
      allSources:
    state:
      currentSources:
      count:

- id: WpsExecute
  type: GroovyActor
  properties:
    step: |
      proc = ['wpsclient', 'execute', 
                    '-s', service,
                    '-i', identifier,
                    '--input', 'input1=1',
                    '--input', 'input2=2',
                    '--output', 'output1',
                    '--output', 'output2',
                    '-o', 'wps_result.json'].execute()
      proc.waitFor()

      import org.yaml.snakeyaml.Yaml
      input = new FileInputStream(new File("wps_result.json"))
      yaml = new Yaml()
      result = yaml.load(input)

      status = 'done'
      output = result[0].reference
    inputs:
      identifier: 
      service:
      file_identifiers:
        type: String
        optional: true
        nullable: true
      input_params:
        type: Collection
        optional: true
        nullable: true
    outputs:
      status: 
      output:

imports:

- classpath:/common/directors.yaml
- classpath:/common/groovy/actors.yaml

components:

- id: StatusWriter
  type: GroovyActor
  properties:
    step: |
      new File(filename).withWriterAppend{ out -> out.println message+', '+info }
    inputs:
      filename:
      message:
      info:

- id: HelloWorld
  type: Workflow
  properties:
    director: !ref MTDataDrivenDirector
    nodes:
    - !ref SayThreeGreetings
    - !ref SayThreeGoodByes
    - !ref RenderGreeting
    - !ref RenderGreetingStdout

- id: SayThreeGreetings
  type: GroovyActorNode
  properties:
    actor.step: 
      message = greeting;
      info = "greeting";
    sequences:
      greeting: 
      - Good morning!
      - Hello!
      - Good night!
    outflows:
      message: /messages/greeting/
      info: /messages/info/

- id: SayThreeGoodByes
  type: GroovyActorNode
  properties:
    actor.step: 
      message = goodbye;
      info = "bye";
    sequences:
      goodbye: 
      - Bye!
      - Tschuess!
      - Au revoir!
    outflows:
      message: /messages/greeting/
      info: /messages/info/
      
- id: RenderGreetingStdout
  type: Node
  properties:
    actor: !ref PrintStreamWriter
    inflows:
      message: /messages/greeting/
 
- id: RenderGreeting
  type: Node
  properties:
    actor: !ref StatusWriter
    constants:
      filename: hello.txt
    inflows:
      message: /messages/greeting/
      info: /messages/info/
